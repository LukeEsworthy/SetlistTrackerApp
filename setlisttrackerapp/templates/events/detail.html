{% extends 'shared/base.html' %} {% block content %}
<h1>{{ event.name }}</h1>
{% now "Y-m-d" as todays_date %}
{% if event.date >= todays_date %}
<form action="{% url 'setlisttrackerapp:event_edit_form' event.id %}" method="GET">
            {% csrf_token %}
  <button class="btn btn-outline-warning">Edit</button>
</form>
{% endif %}

<h3>Date: {{ event.date }}</h3>
<h3>Location: {{ event.location }}</h3>
<h3>Time: {{ event.start_time }} - {{ event.end_time }}</h3>
<h3>Duration: {{ event.duration }} hours</h3>


{% if event.date >= todays_date %}
<h2>Search for songs to add:</h2>
<form action="{% url 'setlisttrackerapp:event' event.id %}" method="get">
  <input name="query" type="text" placeholder="Search song titles..." />
</form>
{% endif %}
<ul>
  {% for song in search_songs %}
  <form action="{% url 'setlisttrackerapp:event' event.id %}" method="POST">
  {% csrf_token %}
  <input type="hidden" value={{song.id}} name="song_id"/>
  <button type="submit">Add</button>
  </form>
  <li>"{{ song.title}}" by {{ song.artist }} || {{song.song_length}}s</li>
  {% endfor %}
</ul>

<h2>Setlist:</h2>
<h4>(Remaining time: {{ event.setlist_remaining_minutes }}m {{ event.setlist_remaining_seconds }}s)</h4>
<ol>
  {% for song in event.songs %}
  <form action="{% url 'setlisttrackerapp:event' event.id %}" method="POST">
  {% csrf_token %}
  <li>"{{ song.title }}" by {{ song.artist }} </br> {{ song.rating }} stars || {{ song.song_length }}s</li>
    <select name ="rating">
      <option value = "1" selected>1</option>
      <option value = "2">2</option>
      <option value = "3">3</option>
      <option value = "4">4</option>
      <option value = "5">5</option>
      </select>
      <input type="hidden" value={{ song.event_song_id }} name="event_song_id"/>
      <button type="submit" class="btn btn-dark btn-sm">Rate</button>
    </form>
  {% endfor %}
</ol>
<p>Total setlist length: {{ event.setlist_length }}s</p>
<h4>Notes:</h4>
<p>{{ event.notes }}</p>

<form action="{% url 'setlisttrackerapp:event' event.id %}" method="POST">
    {% csrf_token %}
    <input type="hidden" name="actual_method" value="DELETE">
    <button class="btn btn-danger">Delete</button>
</form>
{% endblock %}
